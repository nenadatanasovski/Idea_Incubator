# TAK-017: Task Agent REST API Routes

---

## Metadata

| Field | Value |
|-------|-------|
| **Phase** | 4 - API Routes |
| **Depends On** | TAK-016 |
| **Blocks** | TAK-018, TAK-022 (Frontend Dashboard) |
| **Priority** | P1 |
| **Owner** | Build Agent |

---

## Summary

Create REST API endpoints for task CRUD operations, validation, test execution, dependency management, and similarity search.

---

## Context

### API Endpoints

| Method | Endpoint | Purpose |
|--------|----------|---------|
| POST | /api/task-agent/tasks | Create task |
| GET | /api/task-agent/tasks | List tasks |
| GET | /api/task-agent/tasks/:id | Get task details |
| PUT | /api/task-agent/tasks/:id | Update task |
| DELETE | /api/task-agent/tasks/:id | Delete task |
| POST | /api/task-agent/tasks/:id/validate | Validate task |
| POST | /api/task-agent/tasks/:id/execute-tests | Run tests |
| POST | /api/task-agent/task-lists | Create task list |
| GET | /api/task-agent/task-lists | List task lists |
| GET | /api/task-agent/task-lists/:id | Get task list details |
| POST | /api/task-agent/task-lists/:id/approve | Approve for execution |

---

## Requirements

1. **Task Routes**:
   - CRUD operations for tasks
   - Validation endpoint
   - Test execution endpoint
   - Dependency management endpoints
   - Similarity search endpoint

2. **Task List Routes**:
   - Create and manage task lists
   - Approve task list for execution
   - Get execution progress

3. **Features**:
   - Emit WebSocket events for all changes
   - Proper error handling with status codes
   - Input validation

---

## Pass Criteria

**PASS** when ALL of the following are true:

| # | Criterion | How to Verify |
|---|-----------|---------------|
| 1 | File exists | `test -f server/routes/task-agent.ts` returns 0 |
| 2 | Has task routes | `grep -q "router.post.*tasks" server/routes/task-agent.ts` returns 0 |
| 3 | Has task list routes | `grep -q "task-lists" server/routes/task-agent.ts` returns 0 |
| 4 | Has validate endpoint | `grep -q "validate" server/routes/task-agent.ts` returns 0 |
| 5 | Exports router | `grep -q "export default router\|module.exports" server/routes/task-agent.ts` returns 0 |
| 6 | TypeScript compiles | `npx tsc --noEmit server/routes/task-agent.ts` returns 0 |

**FAIL** if any criterion is not met.

---

## Output Files

```
server/routes/
└── task-agent.ts
```

---

## Validation

```bash
npx tsc --noEmit server/routes/task-agent.ts
curl http://localhost:3001/api/task-agent/tasks
```

---

## Next Steps

After completing: Mount routes in api.ts (TAK-018).
