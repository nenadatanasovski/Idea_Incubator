# EVL-002: Red Team Agent Integration

---

## Metadata

| Field          | Value                 |
| -------------- | --------------------- |
| **Phase**      | 4 - Evaluation System |
| **Depends On** | EVL-001               |
| **Blocks**     | EVL-003               |
| **Priority**   | P2                    |
| **Owner**      | Human + Claude Code   |

---

## Summary

Integrate the red team agent that challenges idea assumptions and identifies weaknesses. The red team uses different personas (Skeptic, Realist, First Principles) to provide diverse critical perspectives.

---

## Context

### Red Team Personas

| Persona              | Focus               | Question Style                 |
| -------------------- | ------------------- | ------------------------------ |
| **Skeptic**          | Market/demand       | "Who actually wants this?"     |
| **Realist**          | Execution/resources | "Can you actually build this?" |
| **First Principles** | Assumptions         | "Why do you believe that?"     |

### Challenge Types

| Type            | Description                  |
| --------------- | ---------------------------- |
| **Assumption**  | Challenge unstated beliefs   |
| **Evidence**    | Demand proof for claims      |
| **Alternative** | Propose different approaches |
| **Risk**        | Identify failure modes       |

---

## Requirements

1. **Red Team Engine**:
   - Generate challenges from each persona
   - Target weakest criteria scores
   - Produce actionable questions

2. **Persona Prompts**:
   - Distinct voice for each persona
   - Appropriate severity levels
   - Constructive criticism focus

3. **Challenge Generation**:
   - 3-5 challenges per persona
   - Prioritize by impact
   - Include suggested responses

4. **Integration Points**:
   - Can run standalone
   - Integrates with debate rounds
   - Feeds into synthesis

---

## Pass Criteria

**PASS** when ALL of the following are true:

| #   | Criterion                          | How to Verify                   |
| --- | ---------------------------------- | ------------------------------- |
| 1   | All 3 personas generate challenges | Check output for each           |
| 2   | Challenges are specific            | Not generic criticism           |
| 3   | Weakest areas targeted             | Challenges reference low scores |
| 4   | Responses suggested                | Each challenge has response     |

**FAIL** if any criterion is not met.

---

## Output Files

```
agents/redteam.ts                          <- Red team engine
agents/redteam-personas.ts                 <- Persona definitions
types/redteam.ts                           <- TypeScript types
tests/unit/agents/redteam.test.ts
```

---

## Code Template

```typescript
// agents/redteam.ts

interface Challenge {
  id: string;
  persona: "skeptic" | "realist" | "first-principles";
  type: "assumption" | "evidence" | "alternative" | "risk";
  challenge: string;
  targetCriterion?: string;
  severity: "low" | "medium" | "high";
  suggestedResponse?: string;
}

interface RedTeamResult {
  ideaSlug: string;
  challenges: Challenge[];
  summary: string;
  priorityChallenges: Challenge[];
}

export async function runRedTeam(
  ideaContext: IdeaContext,
  evaluationResult: EvaluationResult,
): Promise<RedTeamResult> {
  const challenges: Challenge[] = [];

  // Find weakest criteria
  const weakSpots = findWeakCriteria(evaluationResult, 3);

  for (const persona of PERSONAS) {
    const personaChallenges = await generateChallenges(
      persona,
      ideaContext,
      weakSpots,
    );
    challenges.push(...personaChallenges);
  }

  return {
    ideaSlug: ideaContext.ideaSlug,
    challenges,
    summary: generateSummary(challenges),
    priorityChallenges: prioritize(challenges),
  };
}
```

---

## Validation

```bash
# Run red team tests
npm test -- tests/unit/agents/redteam.test.ts

# Run red team on idea
npm run evaluate test-idea -- --redteam

# Review challenges
cat users/default/ideas/test-idea/analysis/redteam.md
```

---

## Next Steps

After completing: Orchestrate debate rounds (EVL-003).
