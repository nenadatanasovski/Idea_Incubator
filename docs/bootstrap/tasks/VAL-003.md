# VAL-003: Validation Levels (QUICK to RELEASE)

---

## Metadata

| Field          | Value                |
| -------------- | -------------------- |
| **Phase**      | 8 - Validation Agent |
| **Depends On** | VAL-002              |
| **Blocks**     | VAL-004              |
| **Priority**   | P1                   |
| **Owner**      | Human + Claude Code  |

---

## Summary

Implement four validation levels with increasing thoroughness. Each level runs a specific set of validators with appropriate timeouts and coverage requirements.

---

## Context

### Validation Levels

| Level        | Use Case           | Duration | Validators              |
| ------------ | ------------------ | -------- | ----------------------- |
| **QUICK**    | During development | < 10s    | TypeScript, ESLint      |
| **STANDARD** | Before commit      | < 60s    | + Unit tests            |
| **THOROUGH** | Before merge       | < 5m     | + Integration, Coverage |
| **RELEASE**  | Before deploy      | < 15m    | + Security, E2E         |

### Level Configuration

```typescript
interface ValidationLevel {
  name: string;
  timeout: number;
  validators: ValidatorConfig[];
  thresholds: {
    coverage?: number;
    passRate: number;
  };
}
```

---

## Requirements

1. **Level Definitions**:
   - Define 4 validation levels
   - Configure validators for each
   - Set appropriate timeouts

2. **Validator Selection**:
   - Quick: TypeScript compilation only
   - Standard: + Unit test runner
   - Thorough: + Coverage analyzer
   - Release: + Security scanner

3. **Threshold Configuration**:
   - QUICK: No coverage requirement
   - STANDARD: 50% coverage
   - THOROUGH: 70% coverage
   - RELEASE: 80% coverage + security pass

4. **API Integration**:
   - Accept level parameter in API
   - Default to STANDARD
   - Allow level override

---

## Pass Criteria

**PASS** when ALL of the following are true:

| #   | Criterion                 | How to Verify             |
| --- | ------------------------- | ------------------------- |
| 1   | 4 levels defined          | Check level-configs.ts    |
| 2   | Each level runs correctly | Test each level           |
| 3   | Timeouts enforced         | Test with slow validation |
| 4   | Thresholds applied        | Test with low coverage    |

**FAIL** if any criterion is not met.

---

## Output Files

```
agents/validation/level-configs.ts         <- Level definitions
```

---

## Code Template

```typescript
// agents/validation/level-configs.ts

export const VALIDATION_LEVELS: Record<string, ValidationLevel> = {
  QUICK: {
    name: "Quick",
    timeout: 10000,
    validators: [{ type: "typescript", required: true }],
    thresholds: { passRate: 1.0 },
  },

  STANDARD: {
    name: "Standard",
    timeout: 60000,
    validators: [
      { type: "typescript", required: true },
      { type: "unit-tests", required: true },
    ],
    thresholds: { passRate: 0.95, coverage: 50 },
  },

  THOROUGH: {
    name: "Thorough",
    timeout: 300000,
    validators: [
      { type: "typescript", required: true },
      { type: "unit-tests", required: true },
      { type: "integration-tests", required: false },
      { type: "coverage", required: true },
    ],
    thresholds: { passRate: 0.95, coverage: 70 },
  },

  RELEASE: {
    name: "Release",
    timeout: 900000,
    validators: [
      { type: "typescript", required: true },
      { type: "unit-tests", required: true },
      { type: "integration-tests", required: true },
      { type: "coverage", required: true },
      { type: "security", required: true },
      { type: "e2e", required: false },
    ],
    thresholds: { passRate: 1.0, coverage: 80 },
  },
};
```

---

## Validation

```bash
# Test each level
npm run validate -- --level QUICK
npm run validate -- --level STANDARD
npm run validate -- --level THOROUGH
npm run validate -- --level RELEASE

# Verify timeouts
time npm run validate -- --level QUICK  # Should be < 10s
```

---

## Next Steps

After completing: Integrate test runner (VAL-004).
