# WSK-005: Connection Heartbeat

---

## Metadata

| Field          | Value               |
| -------------- | ------------------- |
| **Phase**      | 17 - WebSocket      |
| **Depends On** | WSK-001             |
| **Blocks**     | None                |
| **Priority**   | P2                  |
| **Owner**      | Human + Claude Code |

---

## Summary

Implement heartbeat mechanism to detect dead connections. Regular pings ensure connections are alive and trigger cleanup for stale ones.

---

## Requirements

1. **Server Heartbeat**:
   - Periodic ping to clients
   - Track last pong time
   - Close dead connections

2. **Client Response**:
   - Respond to pings
   - Track connection health
   - Display status indicator

3. **Cleanup**:
   - Remove dead connections
   - Clean up subscriptions
   - Log disconnections

---

## Pass Criteria

| #   | Criterion         | How to Verify              |
| --- | ----------------- | -------------------------- |
| 1   | Heartbeat running | Check ping/pong            |
| 2   | Dead detected     | Kill client, check cleanup |
| 3   | Status displayed  | Check UI indicator         |

---

## Output Files

```
server/websocket.ts (extended)
```
