# SPC-007: Question Generator

---

## Metadata

| Field | Value |
|-------|-------|
| **Phase** | 1 - Spec Agent |
| **Depends On** | SPC-004 |
| **Blocks** | SPC-008 |
| **Priority** | P2 |
| **Owner** | Build Agent (after Phase 1) |

---

## Summary

Generate clarifying questions when brief is ambiguous or when architecture decisions need user input.

---

## Requirements

1. **Question Types**:
   - BLOCKING: Cannot proceed without answer
   - CLARIFYING: Would improve quality (has default)
   - CONFIRMING: Verify assumption before proceeding
   - PREFERENCE: Multiple valid options, user chooses

2. **Question Generation**:
   - Detect ambiguity in brief
   - Identify multiple architecture options
   - Generate specific, actionable questions

3. **Default Handling**:
   - Provide sensible defaults for non-blocking
   - Document default reasoning
   - Allow user to override

---

## Pass Criteria

**PASS** when ALL of the following are true:

| # | Criterion | How to Verify |
|---|-----------|---------------|
| 1 | File exists | `test -f agents/specification/question-generator.ts` returns 0 |
| 2 | Exports QuestionGenerator | `grep -q "export class QuestionGenerator" agents/specification/question-generator.ts` returns 0 |
| 3 | Has generate method | `grep -q "generate(" agents/specification/question-generator.ts` returns 0 |
| 4 | Has Question interface | `grep -q "interface Question" agents/specification/question-generator.ts` returns 0 |
| 5 | Has BLOCKING type | `grep -q "BLOCKING" agents/specification/question-generator.ts` returns 0 |
| 6 | Has CLARIFYING type | `grep -q "CLARIFYING" agents/specification/question-generator.ts` returns 0 |
| 7 | TypeScript compiles | `npx tsc --noEmit agents/specification/question-generator.ts` returns 0 |
| 8 | Unit tests pass | `npm test -- --grep "question-generator"` passes |

**FAIL** if any criterion is not met.

---

## Output Files

```
agents/specification/
└── question-generator.ts
```

---

## Code Template

```typescript
// agents/specification/question-generator.ts

export type QuestionType = 'BLOCKING' | 'CLARIFYING' | 'CONFIRMING' | 'PREFERENCE';

export interface Question {
  id: string;
  type: QuestionType;
  content: string;
  context: string;
  options?: string[];
  default?: string;
  defaultRationale?: string;
}

export interface QuestionResult {
  questions: Question[];
  blockingCount: number;
  canProceedWithDefaults: boolean;
}

export class QuestionGenerator {
  generate(brief: ParsedBrief, requirements: AnalyzedRequirements): QuestionResult {
    // Detect ambiguity and generate questions
  }

  private detectAmbiguity(brief: ParsedBrief): string[] {
    // Find unclear or missing information
  }

  private identifyArchitectureChoices(requirements: AnalyzedRequirements): Question[] {
    // Multiple valid approaches
  }
}
```

---

## Validation

```bash
npx tsc --noEmit agents/specification/question-generator.ts
npm test -- --grep "question-generator"
```
