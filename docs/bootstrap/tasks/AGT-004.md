# AGT-004: Write Spec Agent Acceptance Tests

---

## Metadata

| Field | Value |
|-------|-------|
| **Phase** | 0 - Agent Bootstrap |
| **Depends On** | AGT-002 |
| **Blocks** | SPC-008 |
| **Priority** | P1 |
| **Owner** | Human |

---

## Summary

Write automated acceptance tests that verify Spec Agent output against reference specs. These tests define "done" for Phase 1.

---

## Requirements

1. **Test Structure**:
   - Test file at `tests/spec-agent/acceptance.test.ts`
   - Uses vitest framework
   - Runnable via `npm test -- --grep "spec-agent"`

2. **Test Cases**:
   - Test 1: Simple feature (simple-counter reference)
   - Test 2: Medium feature (user-profiles reference)
   - Test 3: Complex feature (notifications reference)
   - Test 4: YAML schema validation
   - Test 5: Implementability checks

3. **Comparison Logic**:
   - Structural similarity >= 80%
   - Task count within acceptable range
   - Dependency graph validity

---

## Pass Criteria

**PASS** when ALL of the following are true:

| # | Criterion | How to Verify |
|---|-----------|---------------|
| 1 | Test file exists | `test -f tests/spec-agent/acceptance.test.ts` returns 0 |
| 2 | Has 5+ test cases | `grep -c "it\\(" tests/spec-agent/acceptance.test.ts` >= 5 |
| 3 | Tests simple feature | `grep -q "simple-counter" tests/spec-agent/acceptance.test.ts` returns 0 |
| 4 | Tests medium feature | `grep -q "user-profiles" tests/spec-agent/acceptance.test.ts` returns 0 |
| 5 | Tests complex feature | `grep -q "notifications" tests/spec-agent/acceptance.test.ts` returns 0 |
| 6 | Tests compile | `npx tsc --noEmit tests/spec-agent/acceptance.test.ts` returns 0 |
| 7 | Tests run (can fail) | `npm test -- --grep "spec-agent"` executes without crash |

**FAIL** if any criterion is not met.

---

## Output Files

```
tests/
└── spec-agent/
    └── acceptance.test.ts
```

---

## Validation

```bash
# Run acceptance tests
npm test -- --grep "spec-agent"

# Check test count
grep -c "it(" tests/spec-agent/acceptance.test.ts
```

---

## Next Steps

After completing: Tests will fail initially (no Spec Agent yet). Use as goal for SPC-001 through SPC-008.
