# BLD-009: Git Integration

---

## Metadata

| Field | Value |
|-------|-------|
| **Phase** | 2 - Build Agent |
| **Depends On** | BLD-005 |
| **Blocks** | None |
| **Priority** | P2 |
| **Owner** | Human (then Build Agent) |

---

## Summary

Integrate with git for commit creation, branch management, and change tracking.

---

## Requirements

1. **Commit Management**:
   - Create commits after successful tasks
   - Generate meaningful commit messages
   - Follow project commit conventions

2. **Branch Management**:
   - Create feature branches
   - Track branch state
   - Handle merge conflicts (escalate)

3. **Change Tracking**:
   - Track modified files
   - Detect external changes
   - Support rollback

---

## Pass Criteria

**PASS** when ALL of the following are true:

| # | Criterion | How to Verify |
|---|-----------|---------------|
| 1 | File exists | `test -f agents/build/git-integration.ts` returns 0 |
| 2 | Exports GitIntegration | `grep -q "export class GitIntegration" agents/build/git-integration.ts` returns 0 |
| 3 | Has commit method | `grep -q "commit(" agents/build/git-integration.ts` returns 0 |
| 4 | Has createBranch method | `grep -q "createBranch(" agents/build/git-integration.ts` returns 0 |
| 5 | Has rollback method | `grep -q "rollback(" agents/build/git-integration.ts` returns 0 |
| 6 | TypeScript compiles | `npx tsc --noEmit agents/build/git-integration.ts` returns 0 |
| 7 | Unit tests pass | `npm test -- --grep "git-integration"` passes |

**FAIL** if any criterion is not met.

---

## Output Files

```
agents/build/
└── git-integration.ts
```

---

## Code Template

```typescript
// agents/build/git-integration.ts

export interface CommitResult {
  sha: string;
  message: string;
  files: string[];
}

export class GitIntegration {
  async commit(message: string, files: string[]): Promise<CommitResult> {
    // Stage and commit files
  }

  async createBranch(name: string): Promise<void> {
    // Create and switch to branch
  }

  async rollback(sha: string): Promise<void> {
    // Revert to specific commit
  }

  async getModifiedFiles(): Promise<string[]> {
    // List uncommitted changes
  }
}
```

---

## Validation

```bash
npx tsc --noEmit agents/build/git-integration.ts
npm test -- --grep "git-integration"
```
