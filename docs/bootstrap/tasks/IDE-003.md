# IDE-003: Signal Extraction Enhancement

---

## Metadata

| Field          | Value               |
| -------------- | ------------------- |
| **Phase**      | 3 - Ideation System |
| **Depends On** | IDE-001             |
| **Blocks**     | IDE-006             |
| **Priority**   | P2                  |
| **Owner**      | Human + Claude Code |

---

## Summary

Enhance the signal extraction system to more accurately identify and extract key information from ideation conversations. Signals include artifacts, decisions, risks, and insights.

---

## Context

### Signal Types

| Type         | Description                | Example                        |
| ------------ | -------------------------- | ------------------------------ |
| **Artifact** | Documentable content       | Target user description        |
| **Decision** | User choice or commitment  | "We'll focus on mobile first"  |
| **Risk**     | Potential issue identified | "Competition from big players" |
| **Insight**  | Learning or realization    | "Users prefer simplicity"      |
| **Question** | Unresolved question        | "What's our pricing model?"    |

### Extraction Methods

| Method                | Use Case                            |
| --------------------- | ----------------------------------- |
| **Pattern Matching**  | Structured formats (lists, headers) |
| **Claude Extraction** | Natural language understanding      |
| **Hybrid**            | Pattern first, Claude for ambiguous |

---

## Requirements

1. **Pattern-Based Extraction**:
   - Extract bolded content as potential artifacts
   - Detect list items as features or risks
   - Parse markdown structure

2. **Claude-Based Extraction**:
   - Use Claude to identify signal types
   - Extract confidence scores
   - Handle multi-signal messages

3. **Signal Deduplication**:
   - Detect similar signals
   - Merge or link related signals
   - Track signal evolution

4. **Signal Storage**:
   - Store with session
   - Include source message reference
   - Support signal editing

---

## Pass Criteria

**PASS** when ALL of the following are true:

| #   | Criterion                     | How to Verify                  |
| --- | ----------------------------- | ------------------------------ |
| 1   | Patterns extracted accurately | Test with sample messages      |
| 2   | Claude extraction works       | Test natural language input    |
| 3   | No duplicate signals          | Verify deduplication           |
| 4   | Signals persisted             | Reload session, verify signals |

**FAIL** if any criterion is not met.

---

## Output Files

```
agents/ideation/signal-extractor.ts        <- Extraction logic
agents/ideation/signal-patterns.ts         <- Regex patterns
agents/ideation/signal-deduplicator.ts     <- Deduplication
tests/ideation/signal-extraction.test.ts
```

---

## Code Template

```typescript
// agents/ideation/signal-extractor.ts

interface ExtractedSignal {
  id: string;
  type: "artifact" | "decision" | "risk" | "insight" | "question";
  content: string;
  confidence: number; // 0-1
  source: {
    messageId: string;
    startIndex: number;
    endIndex: number;
  };
  metadata: {
    subType?: string; // e.g., 'target-user', 'mvp-feature'
    extractionMethod: "pattern" | "claude" | "manual";
  };
}

export async function extractSignals(
  message: string,
  context: IdeationContext,
): Promise<ExtractedSignal[]> {
  // 1. Pattern-based extraction
  const patternSignals = extractWithPatterns(message);

  // 2. Claude-based extraction for remaining content
  const claudeSignals = await extractWithClaude(message, {
    existingSignals: patternSignals,
    phase: context.session.phase,
  });

  // 3. Merge and deduplicate
  const allSignals = [...patternSignals, ...claudeSignals];
  return deduplicateSignals(allSignals, context.signals);
}
```

---

## Validation

```bash
# Run extraction tests
npm test -- tests/ideation/signal-extraction.test.ts

# Test with sample messages
echo "
**Target Users**: Young professionals aged 25-35 who want to track expenses.

Key Features:
- Expense tracking
- Budget alerts
- Monthly reports
" | npx ts-node -e "
  const { extractSignals } = require('./agents/ideation/signal-extractor');
  extractSignals(process.stdin.read()).then(console.log);
"
```

---

## Next Steps

After completing: Implement web search integration (IDE-004, optional P3).
