# IDE-007: Multi-Idea Session Support

---

## Metadata

| Field          | Value               |
| -------------- | ------------------- |
| **Phase**      | 3 - Ideation System |
| **Depends On** | IDE-001, IDE-002    |
| **Blocks**     | None                |
| **Priority**   | P4                  |
| **Owner**      | Human + Claude Code |

---

## Summary

Enable sessions to work with multiple related ideas simultaneously. Users can compare ideas, merge concepts, or pivot between variations during a single conversation.

---

## Context

### Use Cases

| Scenario            | Description                             |
| ------------------- | --------------------------------------- |
| **Idea Comparison** | Evaluate two approaches to same problem |
| **Idea Merging**    | Combine best aspects of multiple ideas  |
| **Pivoting**        | Switch focus from one idea to another   |
| **Brainstorming**   | Explore many ideas before selecting one |

### Data Model Changes

```typescript
interface MultiIdeaSession extends IdeationSession {
  ideas: IdeaContext[];
  primaryIdea?: string; // Slug of currently focused idea
  relationships: IdeaRelationship[];
}

interface IdeaRelationship {
  fromIdea: string;
  toIdea: string;
  type: "variant" | "competitor" | "combination" | "pivot";
}
```

---

## Requirements

1. **Multiple Idea Tracking**:
   - Associate session with multiple ideas
   - Track which idea is "active"
   - Switch context between ideas

2. **Cross-Idea Signals**:
   - Signals can reference multiple ideas
   - Comparison signals (pros/cons)
   - Shared signals (same target user)

3. **Idea Relationships**:
   - Define relationship types
   - Track idea ancestry (pivots)
   - Visualize idea graph

4. **UI Support**:
   - Show all ideas in session
   - Switch between ideas
   - Side-by-side comparison view

---

## Pass Criteria

**PASS** when ALL of the following are true:

| #   | Criterion                     | How to Verify                  |
| --- | ----------------------------- | ------------------------------ |
| 1   | Session tracks multiple ideas | Create session with 2+ ideas   |
| 2   | Can switch active idea        | Test switching in conversation |
| 3   | Signals link to ideas         | Verify signal.ideaSlug field   |
| 4   | Relationships stored          | Query relationships table      |

**FAIL** if any criterion is not met.

---

## Output Files

```
database/migrations/xxx_multi_idea_sessions.sql
agents/ideation/multi-idea-manager.ts
server/routes/ideation/multi-idea-routes.ts
frontend/src/components/IdeaComparison.tsx
tests/ideation/multi-idea.test.ts
```

---

## Code Template

```typescript
// agents/ideation/multi-idea-manager.ts

export class MultiIdeaManager {
  async addIdeaToSession(sessionId: string, ideaSlug: string): Promise<void> {
    // Add idea to session's idea list
    // Set as primary if first idea
  }

  async switchPrimaryIdea(sessionId: string, ideaSlug: string): Promise<void> {
    // Update session's primary idea
    // Reload context for new idea
  }

  async createRelationship(
    sessionId: string,
    relationship: IdeaRelationship,
  ): Promise<void> {
    // Store relationship between ideas
    // Update graph
  }

  async getComparisonContext(
    sessionId: string,
    ideaSlugs: string[],
  ): Promise<ComparisonContext> {
    // Load context for multiple ideas
    // Structure for side-by-side analysis
  }
}
```

---

## Validation

```bash
# Run multi-idea tests
npm test -- tests/ideation/multi-idea.test.ts

# Manual test flow
# 1. Create session
# 2. Add first idea
# 3. Add second idea as variant
# 4. Compare the two
# 5. Merge into third idea
```

---

## Next Steps

After completing: Ideation System is feature complete. Proceed with Evaluation System (EVL-\*).
