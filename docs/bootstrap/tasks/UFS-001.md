# UFS-001: Implement Folder Structure Utility

---

## Metadata

| Field | Value |
|-------|-------|
| **Phase** | 2 - Unified File System |
| **Depends On** | FND-002 |
| **Blocks** | UFS-002, UFS-003, UFS-004 |
| **Priority** | P1 |
| **Owner** | Human + Claude Code |

---

## Summary

Create a utility for managing the standardized idea folder structure. This utility creates, validates, and navigates the hierarchical folder structure used to store all idea-related artifacts.

---

## Context

### Folder Structure Standard

```
users/{user-slug}/ideas/{idea-slug}/
├── README.md                    # Core idea overview
├── development.md               # Q&A from development sessions
├── target-users.md              # User personas
├── problem-solution.md          # Problem/solution framing
├── research/
│   ├── market.md                # Market research
│   ├── competitive.md           # Competitive analysis
│   └── technical.md             # Technical feasibility
├── planning/
│   ├── brief.md                 # Handoff brief (Ideation → Spec)
│   ├── mvp-scope.md             # MVP definition
│   └── architecture.md          # High-level architecture
├── build/
│   ├── spec.md                  # Technical specification
│   ├── tasks.md                 # Atomic task breakdown
│   └── decisions.md             # Architecture decisions
└── analysis/
    ├── redteam.md               # Red team challenges
    └── risk-mitigation.md       # Risk responses
```

### Why Unified File System?

| Benefit | Description |
|---------|-------------|
| **Portability** | Ideas can be moved, shared as folders |
| **Version Control** | Git tracks all changes |
| **Agent Readability** | Agents read context from files |
| **Human Readability** | Markdown is human-friendly |

---

## Requirements

1. **Create Folder Function**:
   - Input: userSlug, ideaSlug
   - Creates complete folder structure
   - Creates template files with placeholders
   - Returns path to created folder

2. **Validate Folder Function**:
   - Input: folderPath
   - Checks required files exist
   - Returns validation result with missing items

3. **Get File Path Function**:
   - Input: userSlug, ideaSlug, fileType
   - Returns absolute path to specified file
   - Supports all standard file types

4. **List Ideas Function**:
   - Input: userSlug
   - Returns list of idea slugs for user
   - Includes basic metadata (modified date)

---

## Pass Criteria

**PASS** when ALL of the following are true:

| # | Criterion | How to Verify |
|---|-----------|---------------|
| 1 | Create folder works | Call function, verify structure exists |
| 2 | Validate folder works | Call with valid/invalid folders |
| 3 | Get file path works | Returns correct paths for all file types |
| 4 | List ideas works | Returns correct list of ideas |

**FAIL** if any criterion is not met.

---

## Output Files

```
utils/folder-structure.ts        <- Main utility
types/folder-structure.ts        <- TypeScript types
tests/folder-structure.test.ts   <- Unit tests
```

---

## Code Template

```typescript
// utils/folder-structure.ts

export const FOLDER_STRUCTURE = {
  root: ['README.md', 'development.md', 'target-users.md', 'problem-solution.md'],
  research: ['market.md', 'competitive.md', 'technical.md'],
  planning: ['brief.md', 'mvp-scope.md', 'architecture.md'],
  build: ['spec.md', 'tasks.md', 'decisions.md'],
  analysis: ['redteam.md', 'risk-mitigation.md']
};

export type FileType =
  | 'readme' | 'development' | 'target-users' | 'problem-solution'
  | 'market-research' | 'competitive-research' | 'technical-research'
  | 'brief' | 'mvp-scope' | 'architecture'
  | 'spec' | 'tasks' | 'decisions'
  | 'redteam' | 'risk-mitigation';

export function getIdeaPath(userSlug: string, ideaSlug: string): string;
export function getFilePath(userSlug: string, ideaSlug: string, fileType: FileType): string;
export function createIdeaFolder(userSlug: string, ideaSlug: string): Promise<string>;
export function validateIdeaFolder(folderPath: string): Promise<ValidationResult>;
export function listIdeas(userSlug: string): Promise<IdeaSummary[]>;
```

---

## Validation

```bash
# Run unit tests
npm test -- tests/folder-structure.test.ts

# Verify TypeScript
npx tsc --noEmit

# Manual test
node -e "
  const { createIdeaFolder } = require('./utils/folder-structure');
  createIdeaFolder('test-user', 'test-idea').then(console.log);
"
```

---

## Next Steps

After completing: Migrate existing artifacts to file-based storage (UFS-002).
