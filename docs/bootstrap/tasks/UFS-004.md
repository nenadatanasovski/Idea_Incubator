# UFS-004: Template System for Idea Folders

---

## Metadata

| Field          | Value                   |
| -------------- | ----------------------- |
| **Phase**      | 2 - Unified File System |
| **Depends On** | UFS-001                 |
| **Blocks**     | None                    |
| **Priority**   | P2                      |
| **Owner**      | Human + Claude Code     |

---

## Summary

Create a template system that generates starter content for new idea folders. Templates provide structure and prompts to guide users through documenting their ideas.

---

## Context

### Template Files Location

```
templates/unified/
├── README.md.template
├── development.md.template
├── target-users.md.template
├── problem-solution.md.template
├── research/
│   ├── market.md.template
│   ├── competitive.md.template
│   └── technical.md.template
├── planning/
│   ├── brief.md.template
│   ├── mvp-scope.md.template
│   └── architecture.md.template
├── build/
│   ├── spec.md.template
│   ├── tasks.md.template
│   └── decisions.md.template
└── analysis/
    ├── redteam.md.template
    └── risk-mitigation.md.template
```

### Template Variables

| Variable           | Description              | Example                    |
| ------------------ | ------------------------ | -------------------------- |
| `{{idea_name}}`    | Human-readable idea name | "Personal Finance Tracker" |
| `{{idea_slug}}`    | URL-safe slug            | "personal-finance-tracker" |
| `{{user_name}}`    | User's name              | "John Doe"                 |
| `{{created_date}}` | Creation date            | "2026-01-12"               |
| `{{stage}}`        | Lifecycle stage          | "SPARK"                    |

---

## Requirements

1. **Template Files**:
   - Create template for each file type
   - Include helpful prompts and sections
   - Use template variable syntax

2. **Template Renderer**:
   - Parse template variables
   - Replace with actual values
   - Handle missing variables gracefully

3. **Folder Generator**:
   - Use templates when creating new idea folders
   - Support custom templates per project
   - Validate rendered content

4. **CLI Integration**:
   - `npm run cli capture` uses templates
   - Template selection option

---

## Pass Criteria

**PASS** when ALL of the following are true:

| #   | Criterion             | How to Verify                           |
| --- | --------------------- | --------------------------------------- |
| 1   | All templates created | Check templates/unified/ folder         |
| 2   | Variables replaced    | Create folder, verify no `{{}}` remain  |
| 3   | Templates are helpful | Manual review of prompts                |
| 4   | CLI uses templates    | Run `npm run cli capture`, check output |

**FAIL** if any criterion is not met.

---

## Output Files

```
templates/unified/*.md.template  <- Template files
utils/template-renderer.ts       <- Renderer utility
tests/template-renderer.test.ts  <- Unit tests
```

---

## Code Template

### README.md.template

```markdown
# {{idea_name}}

> Brief one-line description of the idea

---

## Overview

_What is this idea about? Describe it in 2-3 sentences._

## Problem

_What problem does this solve? Who has this problem?_

## Solution

_How does this idea solve the problem?_

## Target Users

_Who would use this? Be specific._

---

## Status

| Field          | Value            |
| -------------- | ---------------- |
| **Stage**      | {{stage}}        |
| **Created**    | {{created_date}} |
| **Confidence** | 0%               |

---

## Next Steps

- [ ] Define target user personas
- [ ] Research market size
- [ ] Identify competitors
- [ ] Clarify MVP scope
```

### Template Renderer

```typescript
// utils/template-renderer.ts

interface TemplateVariables {
  idea_name: string;
  idea_slug: string;
  user_name?: string;
  created_date: string;
  stage: string;
}

export function renderTemplate(
  template: string,
  variables: TemplateVariables,
): string {
  let result = template;

  for (const [key, value] of Object.entries(variables)) {
    const pattern = new RegExp(`{{\\s*${key}\\s*}}`, "g");
    result = result.replace(pattern, value || "");
  }

  return result;
}

export async function renderTemplateFile(
  templatePath: string,
  variables: TemplateVariables,
): Promise<string> {
  const template = await fs.readFile(templatePath, "utf-8");
  return renderTemplate(template, variables);
}
```

---

## Validation

```bash
# Run template tests
npm test -- tests/template-renderer.test.ts

# Create test idea with templates
npm run cli capture -- --name "Test Idea" --slug "test-idea"

# Verify no unreplaced variables
grep -r "{{" users/default/ideas/test-idea/
```

---

## Next Steps

After completing: Implement file watcher for sync (UFS-005, optional P3).
