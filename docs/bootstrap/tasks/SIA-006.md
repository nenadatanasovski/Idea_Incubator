# SIA-006: Knowledge Base Writer

---

## Metadata

| Field | Value |
|-------|-------|
| **Phase** | 9 - Self-Improvement Agent |
| **Depends On** | SIA-004, SIA-005 |
| **Blocks** | SIA-007 |
| **Priority** | P2 |
| **Owner** | Human + Claude Code |

---

## Summary

Implement the Knowledge Base writer that stores extracted gotchas and patterns. Manages deduplication, confidence updates, and entry lifecycle.

---

## Context

### Knowledge Base Schema

| Table | Purpose |
|-------|---------|
| `knowledge_entries` | Gotchas, patterns, decisions |
| `gotcha_applications` | Track gotcha usage |
| `claude_md_proposals` | CLAUDE.md update proposals |

---

## Requirements

1. **Entry Creation**:
   - Write gotchas to KB
   - Write patterns to KB
   - Generate unique IDs

2. **Deduplication**:
   - Check for similar entries
   - Merge duplicates
   - Update confidence scores

3. **Confidence Management**:
   - Initial confidence from extraction
   - Boost on prevention
   - Decay over time

---

## Pass Criteria

| # | Criterion | How to Verify |
|---|-----------|---------------|
| 1 | Entries created | Query KB after write |
| 2 | Dedup works | Add similar, verify merge |
| 3 | Confidence updates | Verify score changes |

---

## Output Files

```
agents/sia/knowledge-writer.ts
agents/sia/duplicate-detector.ts
agents/sia/confidence-tracker.ts
```
